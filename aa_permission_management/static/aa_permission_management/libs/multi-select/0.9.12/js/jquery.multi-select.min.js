!function(e){'use strict';const t=function(t,s){this.options=s,this.$element=e(t),this.$container=e('<div/>',{class:'ms-container'}),this.$selectableContainer=e('<div/>',{class:'ms-selectable'}),this.$selectionContainer=e('<div/>',{class:'ms-selection'}),this.$selectableUl=e('<ul/>',{class:'ms-list',tabindex:'-1'}),this.$selectionUl=e('<ul/>',{class:'ms-list',tabindex:'-1'}),this.scrollTo=0,this.elemsSelector='li:visible:not(.ms-optgroup-label,.ms-optgroup-container,.'+s.disabledClass+')'};t.prototype={constructor:t,init:function(){const t=this,s=this.$element;if(0===s.next('.ms-container').length){s.css({position:'absolute',left:'-9999px'}),s.attr('id',s.attr('id')?s.attr('id'):Math.ceil(1e3*Math.random())+'multiselect'),this.$container.attr('id','ms-'+s.attr('id')),this.$container.addClass(t.options.cssClass),s.find('option').each(function(){t.generateLisFromOption(this)}),this.$selectionUl.find('.ms-optgroup-label').hide(),t.options.selectableHeader&&t.$selectableContainer.append(t.options.selectableHeader),t.$selectableContainer.append(t.$selectableUl),t.options.selectableFooter&&t.$selectableContainer.append(t.options.selectableFooter),t.options.selectionHeader&&t.$selectionContainer.append(t.options.selectionHeader),t.$selectionContainer.append(t.$selectionUl),t.options.selectionFooter&&t.$selectionContainer.append(t.options.selectionFooter),t.$container.append(t.$selectableContainer),t.$container.append(t.$selectionContainer),s.after(t.$container),t.activeMouse(t.$selectableUl),t.activeKeyboard(t.$selectableUl);const l=t.options.dblClick?'dblclick':'click';t.$selectableUl.on(l,'.ms-elem-selectable',function(){t.select(e(this).data('ms-value'))}),t.$selectionUl.on(l,'.ms-elem-selection',function(){t.deselect(e(this).data('ms-value'))}),t.activeMouse(t.$selectionUl),t.activeKeyboard(t.$selectionUl),s.on('focus',function(){t.$selectableUl.focus()})}const l=s.find('option:selected').map(function(){return e(this).val()}).get();t.select(l,'init'),'function'==typeof t.options.afterInit&&t.options.afterInit.call(this,this.$container)},generateLisFromOption:function(t,s,l){let i=this,n=i.$element,o='',a=e(t);for(let e=0;e<t.attributes.length;e++){const s=t.attributes[e];'value'!==s.name&&'disabled'!==s.name&&(o+=s.name+'="'+s.value+'" ')}const c=e('<li '+o+'><span>'+i.escapeHTML(a.text())+'</span></li>'),r=c.clone(),d=a.val(),h=i.sanitize(d);c.data('ms-value',d).addClass('ms-elem-selectable').attr('id',h+'-selectable'),r.data('ms-value',d).addClass('ms-elem-selection').attr('id',h+'-selection').hide(),(a.prop('disabled')||n.prop('disabled'))&&(r.addClass(i.options.disabledClass),c.addClass(i.options.disabledClass));const p=a.parent('optgroup');if(p.length>0){let t=p.attr('label'),l=i.sanitize(t),n=i.$selectableUl.find('#optgroup-selectable-'+l),o=i.$selectionUl.find('#optgroup-selection-'+l);if(0===n.length){const s='<li class="ms-optgroup-container"></li>',a='<ul class="ms-optgroup"><li class="ms-optgroup-label"><span>'+t+'</span></li></ul>';n=e(s),o=e(s),n.attr('id','optgroup-selectable-'+l),o.attr('id','optgroup-selection-'+l),n.append(e(a)),o.append(e(a)),i.options.selectableOptgroup&&(n.find('.ms-optgroup-label').on('click',function(){const t=p.children(':not(:selected, :disabled)').map(function(){return e(this).val()}).get();i.select(t)}),o.find('.ms-optgroup-label').on('click',function(){const t=p.children(':selected:not(:disabled)').map(function(){return e(this).val()}).get();i.deselect(t)})),i.$selectableUl.append(n),i.$selectionUl.append(o)}s=void 0===s?n.find('ul').children().length:s+1,c.insertAt(s,n.children()),r.insertAt(s,o.children())}else s=void 0===s?i.$selectableUl.children().length:s,c.insertAt(s,i.$selectableUl),r.insertAt(s,i.$selectionUl)},addOption:function(t){const s=this;t.value&&(t=[t]),e.each(t,function(t,l){if(l.value&&0===s.$element.find('option[value=\''+l.value+'\']').length){let t=e('<option value="'+l.value+'">'+l.text+'</option>'),i=parseInt(void 0===l.index?s.$element.children().length:l.index),n=void 0===l.nested?s.$element:e('optgroup[label=\''+l.nested+'\']');t.insertAt(i,n),s.generateLisFromOption(t.get(0),i,l.nested)}})},escapeHTML:function(t){return e('<div>').text(t).html()},activeKeyboard:function(t){const s=this;t.on('focus',function(){e(this).addClass('ms-focus')}).on('blur',function(){e(this).removeClass('ms-focus')}).on('keydown',function(l){switch(l.which){case 40:case 38:return l.preventDefault(),l.stopPropagation(),void s.moveHighlight(e(this),38===l.which?-1:1);case 37:case 39:return l.preventDefault(),l.stopPropagation(),void s.switchList(t);case 9:if(s.$element.is('[tabindex]')){l.preventDefault();let t=parseInt(s.$element.attr('tabindex'),10);return t=l.shiftKey?t-1:t+1,void e('[tabindex="'+t+'"]').focus()}l.shiftKey&&s.$element.trigger('focus')}e.inArray(l.which,s.options.keySelect)>-1&&(l.preventDefault(),l.stopPropagation(),s.selectHighlighted(t))})},moveHighlight:function(e,t){let s,l,i=e.find(this.elemsSelector),n=i.filter('.ms-hover'),o=null,a=i.first().outerHeight(),c=e.height();this.$container.prop('id');if(i.removeClass('ms-hover'),1===t){if(o=n.nextAll(this.elemsSelector).first(),0===o.length)if(l=n.parent(),l.hasClass('ms-optgroup')){s=l.parent();let e=s.next(':visible');o=e.length>0?e.find(this.elemsSelector).first():i.first()}else o=i.first()}else if(-1===t&&(o=n.prevAll(this.elemsSelector).first(),0===o.length))if(l=n.parent(),l.hasClass('ms-optgroup')){s=l.parent();const e=s.prev(':visible');o=e.length>0?e.find(this.elemsSelector).last():i.last()}else o=i.last();if(o.length>0){o.addClass('ms-hover');const t=e.scrollTop()+o.position().top-c/2+a/2;e.scrollTop(t)}},selectHighlighted:function(e){const t=e.find(this.elemsSelector),s=t.filter('.ms-hover').first();s.length>0&&(e.parent().hasClass('ms-selectable')?this.select(s.data('ms-value')):this.deselect(s.data('ms-value')),t.removeClass('ms-hover'))},switchList:function(e){e.blur(),this.$container.find(this.elemsSelector).removeClass('ms-hover'),e.parent().hasClass('ms-selectable')?this.$selectionUl.focus():this.$selectableUl.focus()},activeMouse:function(t){const s=this;e('body').on('mouseenter',s.elemsSelector,function(){e(this).parents('.ms-container').find(s.elemsSelector).removeClass('ms-hover'),e(this).addClass('ms-hover')})},refresh:function(){this.destroy(),this.$element.multiSelect(this.options)},destroy:function(){e('#ms-'+this.$element.attr('id')).remove(),this.$element.css('position','').css('left',''),this.$element.removeData('multiselect')},select:function(t,s){'string'==typeof t&&(t=[t]);let l=this,i=this.$element,n=e.map(t,function(e){return l.sanitize(e)}),o=this.$selectableUl.find('#'+n.join('-selectable, #')+'-selectable').filter(':not(.'+l.options.disabledClass+')'),a=this.$selectionUl.find('#'+n.join('-selection, #')+'-selection').filter(':not(.'+l.options.disabledClass+')'),c=i.find('option:not(:disabled)').filter(function(){return e.inArray(this.value,t)>-1});if('init'===s&&(o=this.$selectableUl.find('#'+n.join('-selectable, #')+'-selectable'),a=this.$selectionUl.find('#'+n.join('-selection, #')+'-selection')),o.length>0){o.addClass('ms-selected').hide(),a.addClass('ms-selected').show(),c.prop('selected',!0),l.$container.find(l.elemsSelector).removeClass('ms-hover');const n=l.$selectableUl.children('.ms-optgroup-container');if(n.length>0){n.each(function(){const t=e(this).find('.ms-elem-selectable');t.length===t.filter('.ms-selected').length&&e(this).find('.ms-optgroup-label').hide()});l.$selectionUl.children('.ms-optgroup-container').each(function(){e(this).find('.ms-elem-selection').filter('.ms-selected').length>0&&e(this).find('.ms-optgroup-label').show()})}else if(l.options.keepOrder&&'init'!==s){const e=l.$selectionUl.find('.ms-selected');e.length>1&&e.last().get(0)!==a.get(0)&&a.insertAfter(e.last())}'init'!==s&&(i.trigger('change'),'function'==typeof l.options.afterSelect&&l.options.afterSelect.call(this,t))}},deselect:function(t){'string'==typeof t&&(t=[t]);const s=this,l=this.$element,i=e.map(t,function(e){return s.sanitize(e)}),n=this.$selectableUl.find('#'+i.join('-selectable, #')+'-selectable'),o=this.$selectionUl.find('#'+i.join('-selection, #')+'-selection').filter('.ms-selected').filter(':not(.'+s.options.disabledClass+')'),a=l.find('option').filter(function(){return e.inArray(this.value,t)>-1});if(o.length>0){n.removeClass('ms-selected').show(),o.removeClass('ms-selected').hide(),a.prop('selected',!1),s.$container.find(s.elemsSelector).removeClass('ms-hover');const i=s.$selectableUl.children('.ms-optgroup-container');if(i.length>0)i.each(function(){e(this).find('.ms-elem-selectable').filter(':not(.ms-selected)').length>0&&e(this).find('.ms-optgroup-label').show()}),s.$selectionUl.children('.ms-optgroup-container').each(function(){0===e(this).find('.ms-elem-selection').filter('.ms-selected').length&&e(this).find('.ms-optgroup-label').hide()});l.trigger('change'),'function'==typeof s.options.afterDeselect&&s.options.afterDeselect.call(this,t)}},select_all:function(){const t=this.$element,s=t.val();if(t.find('option:not(":disabled")').prop('selected',!0),this.$selectableUl.find('.ms-elem-selectable').filter(':not(.'+this.options.disabledClass+')').addClass('ms-selected').hide(),this.$selectionUl.find('.ms-optgroup-label').show(),this.$selectableUl.find('.ms-optgroup-label').hide(),this.$selectionUl.find('.ms-elem-selection').filter(':not(.'+this.options.disabledClass+')').addClass('ms-selected').show(),this.$selectionUl.focus(),t.trigger('change'),'function'==typeof this.options.afterSelect){const l=e.grep(t.val(),function(t){return e.inArray(t,s)<0});this.options.afterSelect.call(this,l)}},deselect_all:function(){const e=this.$element,t=e.val();e.find('option').prop('selected',!1),this.$selectableUl.find('.ms-elem-selectable').removeClass('ms-selected').show(),this.$selectionUl.find('.ms-optgroup-label').hide(),this.$selectableUl.find('.ms-optgroup-label').show(),this.$selectionUl.find('.ms-elem-selection').removeClass('ms-selected').hide(),this.$selectableUl.focus(),e.trigger('change'),'function'==typeof this.options.afterDeselect&&this.options.afterDeselect.call(this,t)},sanitize:function(e){let t,s,l=0;if(0===e.length)return l;let i=0;for(t=0,i=e.length;t<i;t++)s=e.charCodeAt(t),l=(l<<5)-l+s,l|=0;return l}},e.fn.multiSelect=function(){const s=arguments[0],l=arguments;return this.each(function(){let i=e(this),n=i.data('multiselect'),o=e.extend({},e.fn.multiSelect.defaults,i.data(),'object'==typeof s&&s);n||i.data('multiselect',n=new t(this,o)),'string'==typeof s?n[s](l[1]):n.init()})},e.fn.multiSelect.defaults={keySelect:[32],selectableOptgroup:!1,disabledClass:'disabled',dblClick:!1,keepOrder:!1,cssClass:''},e.fn.multiSelect.Constructor=t,e.fn.insertAt=function(e,t){return this.each(function(){0===e?t.prepend(this):t.children().eq(e-1).after(this)})}}(window.jQuery);
//# sourceMappingURL=jquery.multi-select.min.js.map