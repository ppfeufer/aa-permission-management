$(document).ready(()=>{'use strict';const e='undefined'!=typeof permissionManagamentSettingsOverrides?objectDeepMerge(permissionManagamentSettingsDefaults,permissionManagamentSettingsOverrides):permissionManagamentSettingsDefaults;console.log('Permission Management Settings:',e);const t=({selector:e='.aa-permission-management',namespace:t='aa-permission-management'})=>{document.querySelectorAll(`${e} [data-bs-tooltip="${t}"]`).forEach(e=>{const t=bootstrap.Tooltip.getInstance(e);return t&&t.dispose(),$('.bs-tooltip-auto').remove(),new bootstrap.Tooltip(e)})},s=t=>{const s=$('#loading-spinner'),n=$('#permissions'),o=$('#selected-element'),{permissionType:a,elementId:r,elementName:l}=t.dataset,c=e.l10n?.[a]??a;n.empty().addClass('d-none'),s.removeClass('d-none'),o.removeClass('d-none').text(`${c}: ${l}`);const i=e.url.api.getPermissions.replace('__permission_type__',a).replace(0,r);fetchGet({url:i,responseIsJson:!1}).then(e=>e).then(t=>{s.addClass('d-none'),n.html(t).removeClass('d-none');const o=`<input type="text" class="form-control mb-3" autocomplete="off" placeholder="${e.l10n.search}">`;$('#permissionSelect').multiSelect({selectableHeader:o,selectionHeader:o,afterInit:function(){let e=this,t=e.$selectableUl.prev(),s=e.$selectionUl.prev(),n=`#${e.$container.attr('id')} .ms-elem-selectable:not(.ms-selected)`,o=`#${e.$container.attr('id')} .ms-elem-selection.ms-selected`;e.qs1=t.quicksearch(n).on('keydown',function(t){if(40===t.which)return e.$selectableUl.focus(),!1}),e.qs2=s.quicksearch(o).on('keydown',function(t){if(40===t.which)return e.$selectionUl.focus(),!1})},afterSelect:function(){this.qs1.cache(),this.qs2.cache()},afterDeselect:function(){this.qs1.cache(),this.qs2.cache()}})}).catch(e=>{console.error('There was a problem with the fetch operation:',e)})},n=e=>{t({selector:e}),$('.btn-edit-permissions').off('click').on('click',e=>{const t=e.currentTarget;s(t)})},o=[{target:0,content:[]},{target:1,content:[]}],a=({selector:t,ajaxUrl:s,initComplete:n=()=>{}})=>{const a=[{targets:[1,2],sortable:!1,searchable:!1,columnControl:o},{target:2,class:'text-end'}];return new DataTable(t,{...e.dataTable,ajax:{url:s,error:(e,s)=>console.error(`Error loading data for table ${t}:`,e,s)},columnDefs:a,order:[[0,'asc']],initComplete:n})};[{selector:'#table-groups',url:e.url.api.getGroups},{selector:'#table-states',url:e.url.api.getStates}].forEach(({selector:e,url:t})=>a({selector:e,ajaxUrl:t,initComplete:()=>{const t=$(e).DataTable();n(e),t.on('draw.dt',()=>n(e))}}))});
//# sourceMappingURL=aa-permission-management.min.js.map